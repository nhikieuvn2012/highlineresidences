(function(n,t){extend("gehc._prototypes.search.view.creator",Backbone.View.extend({events:{'click input[type="submit"]':"clickSubmit",'click button[type="submit"]':"clickSubmit"},initialize:function(n){n=n||{},_.defaults(this,n),_.defaults(this,{inputSelector:".search-input"}),this.searchInput=t(this.inputSelector,this.el)},clickSubmit:function(n){n.type!="keyup"&&n.preventDefault(),this.createSearch()},createSearch:function(){var t,n;t="createSearch",this.namespace&&(t=this.namespace+"."+t),n=this.searchInput.val(),n=n===this.searchInput.attr("placeholder")?"":n,this.latestQuery=n,pubsub.publish(t,[n])},getValue:function(){return this.searchInput.val()}})),extend("gehc._prototypes.search.view.result",Backbone.View.extend({initialize:function(n){n=n||{},_.defaults(this,n)}})),extend("gehc._prototypes.search.view.filterableResults",Backbone.View.extend({events:{"change input:checkbox":"changeCheckbox","click .close":"clickCloseResults","click .reset":"clickResetResults"},initialize:function(n){var i;i=this,n=n||{},_.defaults(this,n),this.searchInput=this.options.searchInput,this.results=t(".search-results",this.el),this.resultsContainer=t(".results-container",this.el),this.resultsList=t("ul",this.resultsContainer),this.featuredImage=t(".featured .featured-image",this.el),this.loadingIndicatorContainer=t(".loading-indicator-container",this.el),this.submitButton=t('input[type="submit"]',this.el),this.focusableUIEls=t("input, button",this.el),this.closeBtn=t(".close-results",this.el),this.foundResultsContainer=t(".found-results",this.el),this.noResultsContainer=t(".no-results",this.el),this.latestQuery||(this.latestQuery=""),pubsub.subscribe("createSearch",function(){i.performSearch()}),this.collection=new gehc._prototypes.search.collection.result([],{url:n.searchUrl}),this.throttledSearch=_.throttle(this.performSearch,500),this.syncFiltersFromDOM()},changeCheckbox:function(n){var i,r,u,f;i=t(n.target),r=i.val(),u=i.data().filterType,f=n.target.checked?"add":"remove",this.changeFilter(r,u,f)},clickCloseResults:function(n){n.preventDefault()},clickResetResults:function(n){n.preventDefault()},showLoadingIndicator:function(){this.loadingIndicatorContainer.show()},hideLoadingIndicator:function(){this.loadingIndicatorContainer.hide()},render:function(){var i,n;return i=this,this.collection.models.length>0?(this.foundResultsContainer.show(),this.noResultsContainer.hide(),n=t(document.createElement("div")),this.removeResults(),this.currentSubCollection=this.collection.filter().limitTo(this.displayLimit),this.currentSubCollection.each(function(i){var r;r=t(Mustache.to_html(this.resultTemplate,i.attributes)),r.data("SearchResultView",new this.resultView({el:r,model:i})),n.append(r)},this),this.featuredResult&&this.featuredImage.attr("src",this.featuredResult.get("imageUrl")).css({display:"block"}),this.resultsList.html(n.children())):(this.foundResultsContainer.hide(),this.noResultsContainer.show(),this.noResultsContainer.find(".attempted-query").html(this.searchInput.latestQuery)),this},removeResults:function(){this.resultsList.children().remove()},reorderResultsBy:function(n,t){this.collection.reorderBy(n,t),this.removeResults(),this.render()},changeFilter:function(n,t,i){i==="add"?this.collection.addFilter(t,n):this.collection.removeFilter(t,n),this.render()},syncFiltersFromDOM:function(){var n=this;t("input:checkbox",this.el).each(function(i,r){r=t(r),r.attr("checked")&&n.collection.addFilter(r.data().filterType,r.val())})},makeFocusable:function(){this.focusableUIEls.removeAttr("disabled"),this.closeBtn.show()},makeUnfocusable:function(){this.focusableUIEls.attr("disabled","disabled"),this.closeBtn.hide()},performSearch:function(n,t){var i=this;this.showLoadingIndicator(),gehc._prototypes.search.util.performSearch(this.searchUrl,n,function(n,r){i.hideLoadingIndicator(),i.collection.reset(),i.collection.add(n.models),t&&t(i.collection,r),i.render()})}}))})(this,jQuery)